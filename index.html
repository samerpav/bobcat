<html>

  <head>
    <link rel="stylesheet" type="text/css" href="style.css" />
    <script src="xbps.js"></script>
    <script src="orbitcam.js"></script>
    <script src="sylvester.js"></script> 
    <script src="glUtils.js"></script> 
    <script src="picking.js"></script>
  </head>

  <!-- <body oncontextmenu="return false;" onLoad="start();" bgcolor="#222222"> -->
  <body oncontextmenu="return false;" bgcolor="#222222"> 

  <!-- <span id="fileStatus"></span><br /> -->

  <input type='file' id='fileinput' value='' onchange='start();'>
  <button type="button" onclick='Upload();'>Upload</button>
  <button type="button" onclick='startServer();'>Load from Server</button>
  <button type="button" onclick='test();'>test</button>
  
  <br>

  <div id="abc"> </div>

  <canvas id="canvas" width="800" height="500"></canvas><br />

  <!--    <span>Invert scroll wheel:</span><input type="checkbox" id="invertScroll" /> -->

  <span id="debug"></span>

  </body>

</html>

<script>
function test() {

		document.getElementById('abc').innerHTML = '';

	for (var i=0; i<=320; i++) {
	   var hsv = new Object();
	   hsv.s = 1;
	   hsv.v = 0.5;
	   hsv.h = i;
	   var rgb = hsv2rgb(hsv);

	   //console.log(i + ' ' + rgb.r.toFixed(3) + ' ' + rgb.g.toFixed(3) + ' ' + rgb.b.toFixed(3));

	   document.getElementById('abc').innerHTML += "<div style='float:left;width:1px; height:50px' id='abc" + i + "'> </div>";
	   //document.getElementById('abc' + i).style.background="rgb(255,0,0)";

	   var s  = "rgb(" + Math.round(rgb.r*255) + "," + Math.round(rgb.g*255) + "," + Math.round(rgb.b*255) + ")"; 
	   //console.log(s);
	   document.getElementById('abc' + i).style.background=s;

	}
}

function hsv2rgb(hsv) {
	var rgb = new Object();

	var c = hsv.v * hsv.s;
	var h2 = hsv.h / 60.0;
	var x = c * (1 - Math.abs(h2 % 2 - 1));

	switch (true) {
			case ((h2 >= 0) && (h2 < 1)):
				rgb.r=c;
				rgb.g=x;
				rgb.b=0;
				break;
			case ((h2 >= 1) && (h2 < 2)):
				rgb.r=x;
				rgb.g=c;
				rgb.b=0;
				break;
			case ((h2 >= 2) && (h2 < 3)):
				rgb.r=0;
				rgb.g=c;
				rgb.b=x;
				break;
			case ((h2 >= 3) && (h2 < 4)):
				rgb.r=0;
				rgb.g=x;
				rgb.b=c;
				break;
			case ((h2 >= 4) && (h2 < 5)):
				rgb.r=x;
				rgb.g=0;
				rgb.b=c;
				break;
			case ((h2 >= 5) && (h2 < 6)):
				rgb.r=c;
				rgb.g=0;
				rgb.b=x;
				break;
		default: rgb.r=rgb.g=rgb.b=0;
	}

	var m = hsv.v - c;

	rgb.r += m;
	rgb.g += m;
	rgb.b += m;

	return rgb;
}

function HSV2RGB_shitty(hsv) {
    var rgb=new Object();
    if (hsv.saturation==0) {
        rgb.r=rgb.g=rgb.b=Math.round(hsv.value*2.55);
    } else {
        hsv.hue/=60;
        hsv.saturation/=100;
        hsv.value/=100;
        i=Math.floor(hsv.hue);
        f=hsv.hue-i;
        p=hsv.value*(1-hsv.saturation);
        q=hsv.value*(1-hsv.saturation*f);
        t=hsv.value*(1-hsv.saturation*(1-f));
        switch(i) {
        case 0: rgb.r=hsv.value; rgb.g=t; rgb.b=p; break;
        case 1: rgb.r=q; rgb.g=hsv.value; rgb.b=p; break;
        case 2: rgb.r=p; rgb.g=hsv.value; rgb.b=t; break;
        case 3: rgb.r=p; rgb.g=q; rgb.b=hsv.value; break;
        case 4: rgb.r=t; rgb.g=p; rgb.b=hsv.value; break;
        default: rgb.r=hsv.value; rgb.g=p; rgb.b=q;
        }
        rgb.r=Math.round(rgb.r*255);
        rgb.g=Math.round(rgb.g*255);
        rgb.b=Math.round(rgb.b*255);
    }
    return rgb;
}

</script>


//<script>
//
//	function testload() {
//
//           var xhr = new XMLHttpRequest();
//           xhr.open('GET', '/load', true);
//           xhr.responseType = 'arraybuffer';
//           
//           xhr.onload = function(e) {
//             var coords = new Float32Array(this.response);
//	     var colors = new Uint8Array(this.response, 3 * Float32Array.BYTES_PER_ELEMENT)
//
//	     debugger;
//           };
//           
//           xhr.send();
//	}
//
//</script>

//<script>
//     function loadFile() {
//        var input, file, fr;
//        if (typeof window.FileReader !== 'function') {
//            bodyAppend("p", "The file API isn't supported on this browser yet.");
//            return;
//        }
//
//        input = document.getElementById('fileinput');
//	/*
//        if (!input) {
//            bodyAppend("p", "Um, couldn't find the fileinput element.");
//        }
//        else if (!input.files) {
//            bodyAppend("p", "This browser doesn't seem to support the `files` property of file inputs.");
//        }
//        else if (!input.files[0]) {
//            bodyAppend("p", "Please select a file before clicking 'Load'");
//        }
//	*/
//
//            file = input.files[0];
//            fr = new FileReader();
//	    fr.onload = function() {showResult(fr)};
//            fr.readAsText(file);
//	    //fr.readAsBinaryString(file);
//    }
//
//    function showResult(fr) {
//        //result = fr.result;
//	//document.write("<pre>" + result + "</pre>");
//	console.log(fr.result.charAt(1));
//    }
//</script>
